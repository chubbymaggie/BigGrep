<?xml version="1.0" encoding="ISO-8859-1"?>
<refentry id='bgsearch.1' lang='en' version="5.0" xmlns="http://docbook.org/ns/docbook">
<refentryinfo><releaseinfo>2.6</releaseinfo></refentryinfo>
<refmeta>
<refentrytitle>BGSEARCH</refentrytitle>
<manvolnum>1</manvolnum>
<refmiscinfo class='source'>Big Grep</refmiscinfo>
<refmiscinfo class='manual'>User Manuals</refmiscinfo>
</refmeta>
<refnamediv id='bgsearchname'>
<refname>bgsearch</refname>
<refpurpose>Search Biggrep index files for one or more search terms.</refpurpose>
</refnamediv>
<!-- body begins here -->
<refsynopsisdiv id='bgsearchsynopsis'>
<cmdsynopsis>
	<command>bgsearch</command>
	<arg choice='opt'><replaceable>options</replaceable></arg>
	<arg choice='req' rep='repeat'><replaceable>search-term</replaceable></arg>
    <sbr/>
</cmdsynopsis>
</refsynopsisdiv>
<refsect1 id='bgsearchoptions'><title>OPTIONS</title>
<variablelist remap='IP'>
  <varlistentry>
    <term><option>-a</option>/<option>--ascii</option></term>
    <listitem>
      <para>Ascii string search term.</para>
    </listitem>
  </varlistentry>
  <varlistentry>
    <term><option>-b</option>/<option>--binary</option></term>
    <listitem>
      <para>Binary hexadecimal string search term.</para>
    </listitem>
  </varlistentry>
  <varlistentry>
    <term><option>-u</option>/<option>--unicode</option></term>
    <listitem>
      <para>Unicode string search term.</para>
    </listitem>
  </varlistentry>
  <varlistentry>
    <term><option>-d</option>/<option>--directory</option>  <replaceable>DIR</replaceable></term>
    <listitem>
      <para id='directorydesc'>Directory to look for .bgi files in.</para>
    </listitem>
  </varlistentry>
  <varlistentry>
    <term><option>-r</option>/<option>--recursive</option></term>
    <listitem>
      <para id='recursivedesc'>Recurse down the directories looking for .bgi files.</para>
    </listitem>
  </varlistentry>
  <varlistentry>
    <term><option>-M</option>/<option>--no-metadata</option></term>
    <listitem>
      <para id='nometadesc'>Do not show metadata associated with each result, if available.</para>
    </listitem>
  </varlistentry>
  <varlistentry>
    <term><option>-v</option>/<option>--verify</option></term>
    <listitem>
      <para id='verifydesc'>Invoke bgverify on candidate answers.</para>
    </listitem>
  </varlistentry>
  <varlistentry>
    <term><option>-y</option>/<option>--yara</option> <replaceable>FILE</replaceable></term>
    <listitem>
      <para>Invoke yara on the specified file to verify candidate answers.  If any of the rules in the yara input match, the candidate will pass verification.  Yara rules that match will be indicated in the result metadata using the YARA_MATCHES value.</para>
    </listitem>
  </varlistentry>
  <varlistentry>
    <term><option>-l</option>/<option>--limit</option> <replaceable>NUM</replaceable></term>
    <listitem>
      <para id='limitdesc'>Halt search and verify when the number of candidates exceeds NUM. This option has no effect without specifying -y or -v.  Specify a limit of 0 to disable the default limit of 15,000.</para>
    </listitem>
  </varlistentry>
  <varlistentry>
    <term><option>-f</option>/<option>--filter</option> <replaceable>CRITERIA</replaceable></term>
    <listitem>
      <para>Metadata filter criteria.  If multiple filters are specified, candidates must pass all criteria.  Supported operators: =,&lt;,&gt;,&lt;=,&gt;=,!= Some of these operators may have meaning in the shell you are using, it's a good idea to encapsulate the filter in quotes. (eg. &quot;size&gt;=1024&quot;)</para>
      <para>Some indexes may not have the same metadata as others.  If your filter criteria use metadata that isn't available for a candidate, it will not be used to filter out that candidate.  If no other filter criteria fail, this candidate will be included in the candidate list.  The missing metadata will be indicated in the result metadata using the FILTER_MISSING_METADATA value.
      </para>
      <para>The following metadata is generated at search/verification time and cannot be used with a filter: YARA_MATCHES, FILTER_MISSING_METADATA.</para>
    </listitem>
  </varlistentry>
  <varlistentry>
    <term><option>-n</option>/<option>--numprocs</option> <replaceable>NUM</replaceable></term>
    <listitem>
      <para id='numprocsdesc'>Number of simultaneous .bgi files to search. (default 12)</para>
    </listitem>
  </varlistentry>
  <varlistentry>
    <term><option>--banner</option> <replaceable><filename class="directory">PATH</filename></replaceable></term>
    <listitem>
      <para id='bannerdesc'>Path to a text file to display as a banner/MOTD.</para>
    </listitem>
  </varlistentry>
  <varlistentry>
    <term><option>-i</option>/<option>--index-order</option> <replaceable>INDEX_ORDER</replaceable></term>
    <listitem>
      <para id='indexorderdesc'>Alter the order in which index files are searched.  Possible values for <replaceable>INDEX_ORDER</replaceable> are: "shuffle" and "alpha"  "alpha" will sort all index files from all directories in alphabetic order based on file name.  "shuffle" will shuffle the order in a pseudo-random manner.  The order in which index files are searched is not random, and may be the same between runs.</para>
    </listitem>
  </varlistentry>
  <varlistentry>
    <term><option>-t</option>/<option>--throttle</option> <replaceable>NUB</replaceable></term>
    <listitem>
      <para id='throttledesc'>Throttle index parsing when this many candidates are buffered.  This can help to eliviate memory consumption, and improve overall throuughput when executing a query that produces a very large number of candidates.  Default: 10,000</para>
    </listitem>
  </varlistentry>
  <varlistentry>
    <term><option>-V</option>/<option>--verbose</option></term>
    <listitem>
      <para>Verbose output.</para>
    </listitem>
  </varlistentry>
  <varlistentry>
    <term><option>-D</option>/<option>--debug</option></term>
    <listitem>
      <para>Diagnostic output.</para>
    </listitem>
  </varlistentry>
  <varlistentry>
    <term><option>--version</option></term>
    <listitem>
      <para>Display version number.</para>
    </listitem>
  </varlistentry>
</variablelist>
</refsect1>
</refentry>

